#Tips For APP Functional Testing功能测试
设计功能测试用例，一定要考虑如下问题：

* 产品有什么特点？
* 产品会处于什么系统结构下使用？Android/iOS/Winphone/Blackberry...
* 产品本身的系统架构？如产品的各个资源文件保存在系统哪个目录，权限如何
* 用户最关心的功能是什么？

除了需求里面的功能和分支覆盖，移动端更注重使用场景和环境，可以参考以下内容进行用例设计


##1 多分辨率测试
Android设备的屏幕、分辨率组合非常多，需要根据APP的用户分布情况安排测试的覆盖范围。注意模拟器的测试结果仅限参考，真机的表现是非常不同的。

iOS的主要要考虑itouch、iPad、iPhone，分普通分辨率和Retina分辨率，由于模拟器上无法测试越狱系统，所以还是推荐真机。
##2 多系统测试
根据市场分布情况，一般需要覆盖Android的2.3.3/4.0.*/4.1...

iOS的多系统测试需要注意：新系统可能会提供一些老系统不兼容的资源库，如果APP使用了这些资源库，在老系统中就会Crash.
##3 用户不同的使用习惯
###3.1 Android
####3.1.1 Android权限
APP往往需要获取各种权限，比如需要通过短信验证的应用要有短信SMS的使用权限，有的需要有系统联系人Contacts的权限，拍照软件要有相机Camera的使用权限等。市面上的安全软件都有查看手机上应用使用权限的功能，因此如果应用在后台偷偷获取用户数据，会被用户发现进而造成不良印象。

一个应用的权限在AndroidManifest.xml中可以配置，都是类似
`<uses-permission android:name="android.permission.CAMERA"/>`

测试工程师需要了解被测对象使用了哪些权限、为什么使用、是否会对用户造成困扰等。
####3.1.2 Android硬件问题
机器硬件的差异会造成软件上的缺陷。例如有的机器有物理键盘，对依赖虚拟键盘的软件就可能产生问题；有的机器有实体方向键或者滚轮（HTC的某机型），会使软件在使用过程中的焦点发生移动，很可能NPE；还有大量的山寨机支持双卡双待，需要读取Sim卡信息的软件可能就会出问题。还有摄像头、GPU的限制也可能导致软件异常。
####3.1.3 Android操作习惯
主要需要考虑菜单键Menu、Home键、返回键Back、Home键长按（显示当前进程列表）、调整音量、待机。

* 应用中Back键事件是否被重写？点击Back键是否是后退？
* 在各页面点Home键后再次打开应用，之前是处于后台还是结束生命周期了？
* 应用是否用到菜单键来交互
* 应用在任何状态下，系统待机或关机，系统被重新唤醒后应用是否能正常使用
* 应用进程被手动关闭后，是否可以再次正常启动
* ...

####3.1.4 Android数据的移动或清空
很多用户会把应用数据转移到SD卡，在setting中“强制关闭”应用、清除缓存等等，这些场景都需要测试到。

某些第三方软件会提供用户一个功能：自动关闭后台运行的程序，这个功能很可能是勾选了开发者设置中的"Don't Keep Activities"，这对应用也会有一些影响，所以测试时需要模拟这种情况。
###3.2 iOS
####3.2.1 用户操作习惯
用户常用操作：

* 单击Home键
* 双击Home键
* 关闭某应用进程
* 打开或关闭音量
* 调整音量
* 待机

针对这些操作也应该设计一些测试场景。
####3.2.2 越狱
常用的越狱工具：红雪、绿毒、jailbreakme
用户越狱之后，系统就会变得不稳定，应用之间可能产生冲突。例如：

* 输入法：越狱之后用户安装的一些输入法软件很可能导致APP Crash，因此在输入框对不同输入法的测试就很有必要
* 美化主题类的插件：一部分美化插件会让其他应用界面的皮肤变得不堪入目甚至Crash
* 垃圾插件或手机管理软件：例如一些管理软件会将后台应用强制关闭，那么用户想用SSO([Single Sign On](http://baike.baidu.com/subview/190743/15011802.htm))方式登陆一些应用就变死循环了，从应用A跳到社交应用B--选择自己的账号--（正常情况下是使用该账号登陆）跳回A继续选择社交应用（正常情况下是使用该账号登陆）。

##4 网络不稳定性
用户的碎片时间一般很多用在地铁、电梯、洗手间这些网络不好的地方，那么应用对这些网络连接变化、容错的测试场景就很有必要了。

* 对网络连接不上、无网络、服务错误的提示是否友好？一律提示为“网络错误，请稍后再试”其实是很不友好的
* 网络的切换场景：原本畅通的3G/4G网络突然变弱，断开瞬间，然后重新连接上，那么这个过程中应用的请求必然会用到一个连接超时设置，会有重试机制。与其设计复杂的方法模拟，不如花一天，带上必需设备，进入网络很差的实际场所测试，这样既不浪费时间，还能最接近真实场景。
* 长连接：很多应用会使用长连接增强网络稳定性，那么除了容错和网络切换测试，还需要在不同网络环境下根据服务器设置的心跳时间进行边界值测试。

##5 安装、卸载测试
* 命令行安装：不要小看Android用户的动手能力`adb install <package name>`
* 第三方安装：例如豌豆荚、91助手
* 将应用下载到SD卡再安装。有些Android应用由于数据量大，允许用户将应用的部分数据在内存和SD卡中相互转移，转移之后的正常运行也是很重要的测试点。
* 小体积的应用安装（通过在线下载数据的方式使用，很多游戏应用会这样），对这些应用要注意：
	* 不联网时能否正常使用，是否会crash
	* 在线下载的数据不完整，能否再次启动
	* 是否支持断点续传
	* 下载完成后再次启动
	* 安装完成后，检查版本号和相关数据 	
* iOS的下载渠道一般有itunes、app store、testflight， Android有各种平台、工具、渠道包等等比iOS复杂的多

##6 升级
一个应用要被升级的几个必要条件：

* 新旧版本的应用有相同的签名
* 有相同的包名
* 有版本号来标识新老

主要需要注意升级到底改了哪些文件，这些文件又影响了哪些功能合数据库，然后有针对性的测试。
### Andorid升级的两种特殊情况
#### 增量升级
也叫差分升级(Smart App Update)，也就是只需要额外下载增加的部分，不需要下载完整包。但是这种升级目前没有广泛应用，存在两个问题：

* 对于多个老版本，需要多个增量补丁Patch，虽然补丁能自动生成，但是依然很麻烦
* 如果一部分系统没有拿到内置应用的权限，就没办法增量升级

#### 内置应用升级
有些应用内置在系统内部之后，企业会希望升级到最新版本。但是Android系统繁多，内置以后情况比较复杂。例如，如果应用中有.so文件（输入法），往往内置系统后会保存在/system级目录下，无论用户还是应用都没有访问权限。应用的其他资源文件可以升级，那么每次升级后是否和内置的.so文件匹配，不匹配就直接导致crash。

##7 并发测试
主要是指多个应用多个事件同时触发的情况

* 弹出框提示：闹钟提示、低电量提示、短信、来电等等。这些会让应用进入pause状态，用户响应完提示后应用能否继续正常运行
* 另一个应用启动：
	* 应用正在播放视频
	* 正在向服务器发送或者接收请求
	* 正在下载数据或者升级
	* 正在进行输入

这些时候如果用户接电话或者回短信或者快捷启动相机等，很可能出现不可预见的问题。

* 关机或待机后恢复使用，功能是否正常，数据是否丢失
* 功能冲突：例如正在播放视频时，短信提示语音会强制暂停当前播放的视频音频，之后能否继续正常播放
* 可存储设备：如将智能手机当成存储设备使用时，应用获取资源（手机中的图片、音乐等）很容易导致Crash

##8 数据来源
目前很多数据不再是用户输入、选择应用提供的选项、从剪贴板中复制粘贴获取、语音输入了，可能是来自云端服务等等，遇到和文件相关的测试，这些测试场景就要考虑周全。

例如图片，如果某个模块的功能是允许用户在签到、发信息、回复等操作时都能够带图片，如何设计用例？

可能会想到

* 用移动设备直接拍照
* 载入移动设备中的图片

除了这些，可能还会想到

* 不同分别率的图片
* 不同大小的图片
* 不同格式的图片

再考虑下移动设备用户的操作习惯，就会有如下结论：

* 很多人喜欢自拍，那么需要考虑前置摄像头
* 用户喜欢拼图
* 用户喜欢使用美图软件修图
* 手机的全景图片
* 用户从电脑导入移动设备的图片
* 用户从各种应用或网站保存到本地的图片

是否还有别的用户感觉不到、确经常发生的场景？

* 智能机中的图片可能来自某应用的临时文件
* Google、Chrome等邮箱、应用，会在用户登录时将用户账户下的图片同步到本地
* 某些网页会将临时文件保存在本地

那么这些不同来源的图片，除了大小、分辨率等，还有那些数据不同，这些数据（如图片的元数据）中某个不存在会对应用产生什么影响？

##9 推送
* 智能机在关机、待机、打开等状态下执行推送的功能、消息提示以及推送跳转是否正确
* 应用在打开、未打开状态，应用启动且在后台运行的情况下，查看推送功能、消息显示及推送跳转是否正确
* 多次推送的情况，推送的成功率
* 主动推送、被动推送的场景
* 推送的消息在阅读后表示消息数量的数字是否改变
* 单条或多条推送的文字显示及跳转是否正确
* 多语言环境下，推送的本地化翻译信息是否正确

##10 分享跳转
有的分享需要跳转应用，如分享到微信；有的可以直接分享成功，如分享到微博。分享不成功可能是因为绑定账号token过期，所以测试分享一般要注意：

* 模拟token过期
* 同时关注Android和iOS两个平台的分享功能
* 分享到微博、微信后，关注在这些平台上消息的来源及点击后的跳转是否正确
* 如果分享的文案有动态变化，需要加以关注

##更多。。。
除了这些点，对每一个应用，都要尽量设身处地去在生活中使用，从真实的使用场景、使用流程来挖掘用例。
##参考资料
《大话移动APP测试》- 陈晔